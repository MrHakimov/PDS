\section{Самостабилизация: взаимное исключение}

\begin{definition} \textit{Самостабилизация:}
    \begin{itemize}
        \item Легальное состояние остаётся легальным.
        \item Из любого состояния попадём в легальное через конечное число шагов.
    \end{itemize}
\end{definition}

\begin{example}
    Существует алгоритм самостабилизации для \textit{взаимного исключения}, 
    где ровно один процесс имеет привилегию.
\end{example}

\begin{definition} \textit{Состояние системы:}
    \begin{itemize}
        \item $N$ машин расположены в кольце. Каждая имеет $K$ состояний 
            $(K \geqslant N)$.
            Если состояние меняется, информация отправляется по часовой стрелке дальше.
        \item Машина имеет привилегию, если:
            \begin{itemize}
                \item Для первой: $S = L$. Состояние первой машины равно состонию 
                    машины слева (влево это против часовой стрелки).
                \item Для остальных: $S \neq L$.
            \end{itemize}
    \end{itemize}
\end{definition}

\begin{definition} \textit{Правила перехода между состояниями:}
    \begin{itemize}
        \item Для первой: $S \neq L \Lra S \coloneqq (S + 1) \mod K$.
        \item Для остальных: $S \neq L \Lra S \coloneqq L$.
    \end{itemize}
\end{definition}

\begin{theorem} 
    \textit{Данный алгоритм самостабилизируется.}
\end{theorem}
\begin{proof}
    \enewline
    \begin{itemize}
        \item Очевидно, что легальное состояние остаётся легальным.
        \item Легальное состояние достигается через конечное число ходов
            из любого состояния:
            \begin{itemize}
                \item Как минимум одна машина имеет привилегию и может ходить.
                    Действительно, если все состояния одинаковые, то первая
                    машина может ходить. Иначе есть две пары процессов-соседей
                    с разными состояниями, и в хотя бы одной из этих пар
                    найдется процесс с привилегией.
                \item Первая машина сдвинется через через $\cO(N^2)$. В худшем
                    случае привилегия будет передаваться с последних двух
                    процессов в кольце, постепенно добавляя первые процессы. 
                \item Рано или поздно первая машина будет иметь уникальный S
                    (т.к. $K \geqslant N$ и только первая машина имеет право 
                    на изменение состояния).
                \item После этого через $\cO(N^2)$ система стабилизируется.
            \end{itemize}
    \end{itemize}
\end{proof}

