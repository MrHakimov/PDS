\section{Взаимное исключение в распределённой системе. Алгоритм Лампорта}

\begin{table}[!ht]
    \centering
    \begin{tabular}{|c|c|} \hline
    Вид запроса & Действие \\ \hline
    $request$ & От запрашивающего ко всем другим узлам\\ \hline
    $ok$ & Подтверждение получения (не даёт права входа в CS) \\ \hline
    $release$ & Освобождение узлом критической секции (всем узлам) \\ \hline
    \end{tabular}
    \caption{Виды запросов алгоритма Лампорта}
\end{table}

\begin{algorithm}(Алгоритм Лампорта)
\begin{itemize}
    \item Координатор отсутствует, все узлы равны
    \item Сообщения request и release рассылаются всем другим узлам, всего $3n-3$ сообщения на CS
    \item Используются логические часы лампорта.
        Для установления порядка "кто раньше".
        Обязательно требуется порядок FIFO на сообщениях
    \item Все узлы хранят у себя очередь запросов
    \item В критическую секцию можно войти, если
        \begin{itemize}
            \item Мой запрос первый в очереди, т.е. его время меньше времени остальных запросов
                (при равенстве времен порядок определяется по номеру узла, который посылается вместе с часами)
            \item Получен ok от всех других узлов, т.е. они знают о вашем запросе
        \end{itemize}
    \item Если узел хочет войти в CS, то он посылает всем другим узлам request со своими часами и id.
        Ждёт от всех ok. Если других запросов не поступало, либо время нашего запроса меньше времени других запросов, то
        входим в критическую секцию. Иначе ждем release от всех узлов, которые раньше нас в очереди.
\end{itemize}
\end{algorithm}

